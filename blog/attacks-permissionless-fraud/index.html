<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Some Attacks on Optimistic Systems | Willem Olding</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://willemolding.github.io/blog/attacks-permissionless-fraud"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="research blockchain cryptocurrency cryptography"><meta data-rh="true" property="og:title" content="Some Attacks on Optimistic Systems | Willem Olding"><meta data-rh="true" name="description" content="In theory optimistic systems promise an honest minority assumption. Any actor can watch the state of the system progress and report fraud by challenging a particular state transition. This comes with the guarantee that they will always win a challenge game against an invalid state transition."><meta data-rh="true" property="og:description" content="In theory optimistic systems promise an honest minority assumption. Any actor can watch the state of the system progress and report fraud by challenging a particular state transition. This comes with the guarantee that they will always win a challenge game against an invalid state transition."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-01-04T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/willemolding"><meta data-rh="true" property="article:tag" content="fault-proofs,rollups"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://willemolding.github.io/blog/attacks-permissionless-fraud"><link data-rh="true" rel="alternate" href="https://willemolding.github.io/blog/attacks-permissionless-fraud" hreflang="en"><link data-rh="true" rel="alternate" href="https://willemolding.github.io/blog/attacks-permissionless-fraud" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Willem Olding RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Willem Olding Atom Feed"><link rel="stylesheet" href="/assets/css/styles.97af0be6.css">
<link rel="preload" href="/assets/js/runtime~main.e7e16834.js" as="script">
<link rel="preload" href="/assets/js/main.593b8190.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Willem Olding</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="navbar__item"><style>
  @media screen and (max-width: 996px) {
    .custom_menu__link {
        color: var(--ifm-menu-color);
        flex: 1;
        line-height: 1.25;
        padding: var(--ifm-menu-link-padding-vertical)
          var(--ifm-menu-link-padding-horizontal);
    }
  }
</style>
<a target="_blank" rel="noopener noreferrer" class="navbar__link custom_menu__link" href="/resume.pdf">
  Resume
</a></div><a href="https://github.com/willemolding" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/attacks-permissionless-fraud">Some Attacks on Optimistic Systems</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/feasibility-fault-proof-bridges">On the feasibility of a Fault-proof Based Blockchain Bridge</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/zipline-lightning">Zipline Lightning Talk at Gnosis Builders (Video)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/preimge-oracle">What is a Pre-image Oracle and why is it awesome?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/issues-with-gaming">Right now there is no such thing as web3 gaming (Opinion)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/fair-airdrops">Fairer Airdrops - An Investigation (Video)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/polynomial-commitments">Intro to Polynomial Commitments (Video)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/fast-exits">Fast Exits from Optimistic Rollups (Video)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Some Attacks on Optimistic Systems</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-01-04T00:00:00.000Z" itemprop="datePublished">January 4, 2023</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/willemolding" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/willemolding.png" alt="Willem Olding"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/willemolding" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Willem Olding</span></a></div><small class="avatar__subtitle" itemprop="description">Computer Systems Engineer, PhD</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>In theory optimistic systems promise an honest minority assumption. Any actor can watch the state of the system progress and report fraud by challenging a particular state transition. This comes with the guarantee that they will always win a challenge game against an invalid state transition.</p><p>In practice though many of the optimistic rollups in production do not currently have this property. In Arbitrum for example the ability to challenge state transitions is limited to a permissioned validator set<sup id="fnref-1-d304be"><a href="#fn-1-d304be" class="footnote-ref">1</a></sup>. </p><p>I spent some time thinking about some potential attacks against permissionless optimistic systems and, at least for the model system I considered, it appears the honest minority assumption comes with some strings attached when real world considerations such as gas costs come into play.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="model-system">Model System<a class="hash-link" href="#model-system" title="Direct link to heading">​</a></h2><p>Lets consider an abstracted optimistic system. This is not a rollup but rather a general iterative computation without inputs. Each state can be transitioned to the next state by executing the state transition function. </p><p>You could consider such a system similar to a programming loop with the state being the loop variables and  for each execution of the loop code the hash of the new loop state is submitted on-chain. </p><p>The challenge game itself has the following properties:</p><ul><li>Anyone can submit a new state commitment at a given sequence number (permissionless updates). This requires including a bond $B$</li><li>The first state commitment to have no open challenges after the finalization period, $T_{final}$, becomes finalized. Other submissions for the same sequence number are discarded and their bonds slashed.</li><li>Anyone can challenge an update that has not finalized (permissionless challenges). This also requires submitting a bond $B$. The submitter and the challenger are now in a challenge game.</li><li>No new challenges can be submitted after $T_{final}$. This prevents stalling attacks.</li><li>Any number of challenges can be opened on an update at once. This is required to ensure the honest minority assumption. If only a limited number of challenges are allowed then dishonest challengers could occupy all the slots.</li><li>The challenge game is a 2-party interactive game and requires on-chain submissions by both the defender (formerly submitter) and challenger. The gas cost for the defender is $g<em>d$ and for the challenger is $g_c$. Each participant has time to respond $T</em>{chal}$. </li><li>The winner of a challenge game receives half of the losers bond. The remainder of the loser bond is burnt.</li></ul><p>Lets also define some properties of the host chain:</p><ul><li>Each block has a gas limit $G$</li><li>The block time is $t_{block}$</li><li>A stable gas price of $p$</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="first-attack---challenger-dos">First Attack - Challenger DoS<a class="hash-link" href="#first-attack---challenger-dos" title="Direct link to heading">​</a></h2><p>This one is nothing new but will serve as a good first example using our model.</p><p>For this attack a malicious submitter submits an invalid state transition. They then prevent any challenger from challenging them by purchasing enough blockspace that the challenge transaction cannot fit for every block in the finalization period $T_{final}$. The cost of this attack is</p><p>$$
c = (G - g<em>c) \frac{T</em>{final}}{t_{block}} p
$$</p><p>It can be seen that the only system specific parameters this depends on is the finalization time and the gas cost of a challenge response. Since the gas cost is usually fixed this attack is typically protected against by using a very large finalization time (e.g. 7 days).</p><p>The finalization time should be selected such that the cost of executing the attack exceeds the exploitable value ever expected to be held in the system.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="second-attack---challenge-flooding">Second Attack - Challenge Flooding<a class="hash-link" href="#second-attack---challenge-flooding" title="Direct link to heading">​</a></h2><p>This is an attack on an honest submitter. It is designed to steal their stake and delay finalization of the system.</p><p>It works by a malicious challenger submitting many ($N$) challenges on a single valid submission. The defender must respond to all of these challenges in order to defend their bond. The attack succeeds if the defender does not have sufficient funds to pay the gas to respond to all these challenges. Because the challenges are overlapping the defender cannot use the winnings from one to pay the gas for the others <sup id="fnref-2-d304be"><a href="#fn-2-d304be" class="footnote-ref">2</a></sup>.</p><p>The cost of this attack to the challenger depends on if it succeeds or fails. If it succeeds the challenger receives the defenders bond and prevents the update from finalizing. If it succeeds the cost is</p><p>$$
c = N p g_{c}.
$$</p><p>If it fails the cost to the challenger is</p><p>$$
c = N (B + p g_{d})
$$</p><p>and the defender wins $\frac{N B}{2}$. There is also a possibility of partial success where the defender can take some of the challenges but not others.</p><p>The conditions for this attack to be possible require an attacker with vastly more funds than the defender. The capital required to conduct this attack is</p><p>$$
C<em>{attack} = N (B +p  g</em>{c})
$$</p><p>and to defend against it is</p><p>$$
C<em>{defend} = N p g</em>{d}
$$</p><p>and so to successfully conduct this attack requires an attacker with more funds than the defender by a factor of</p><p>$$
\frac{B + p g_{c}}{p g_d}.
$$</p><p>The implications for this are quite significant. If we consider the existence of mega-whales (like Coinbase). These actors could successfully conduct this attack at a very low cost on almost any submitter. By doing this repeatedly they can prevent any valid updates from being accepted and stall the system. </p><p>If we assume the gas costs cannot be changed the only way to mitigate this attack is to increase the bond size. With a sufficiently large bond relative to the defender gas cost this simultaneously limits which actors are able to make this attack while also limiting the accounts that can participate at all.</p><p>From this I conclude that for the described system the unbounded honest minority assumption does not hold. It should be reduced to an honest minority in the set of accounts with funds within a factor of $\frac{p g<em>d}{B+ p g</em>{c}}$ of the largest gas token holder.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="looking-forward">Looking Forward<a class="hash-link" href="#looking-forward" title="Direct link to heading">​</a></h2><p>A recent article <sup id="fnref-3-d304be"><a href="#fn-3-d304be" class="footnote-ref">3</a></sup> was published (after I wrote this blog post!) that proposes a modification to the interactive game that could allow honest actors to band together and share the gas costs. See my next article for how this could be used to protect against the challenge flooding attack.</p><div class="footnotes"><hr><ol><li id="fn-1-d304be"><a href="https://l2beat.com/scaling/projects/arbitrum/" target="_blank" rel="noopener noreferrer">https://l2beat.com/scaling/projects/arbitrum/</a><a href="#fnref-1-d304be" class="footnote-backref">↩</a></li><li id="fn-2-d304be">At first glance one might think that the submitter could use the reward from one challenge game to pay the gas of the next one. This would be true if the challenge game was single-step (e.g. non-interactive) however the additional timeout period introduced by the interactive game means that the defender must wait to receive their half of the challengers bond and in this time they must respond to the other challenges or risk losing the interactive game through a timeout.<a href="#fnref-2-d304be" class="footnote-backref">↩</a></li><li id="fn-3-d304be"><a href="https://arxiv.org/pdf/2212.12439.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2212.12439.pdf</a><a href="#fnref-3-d304be" class="footnote-backref">↩</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/fault-proofs">fault-proofs</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/rollups">rollups</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/feasibility-fault-proof-bridges"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">On the feasibility of a Fault-proof Based Blockchain Bridge</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#model-system" class="table-of-contents__link toc-highlight">Model System</a></li><li><a href="#first-attack---challenger-dos" class="table-of-contents__link toc-highlight">First Attack - Challenger DoS</a></li><li><a href="#second-attack---challenge-flooding" class="table-of-contents__link toc-highlight">Second Attack - Challenge Flooding</a></li><li><a href="#looking-forward" class="table-of-contents__link toc-highlight">Looking Forward</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://github.com/willemolding" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://www.linkedin.com/in/willem-olding/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://twitter.com/WillemOlding1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Willem Olding. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e7e16834.js"></script>
<script src="/assets/js/main.593b8190.js"></script>
</body>
</html>